#!/usr/bin/env groovy
/**
 * The following packages are automatically imported in Groovy:
 *
 *   import java.lang.* 
 *   import java.util.* 
 *   import java.io.* 
 *   import java.net.* 
 *
 *   import groovy.lang.* 
 *   import groovy.util.* 
 *
 *   import java.math.BigInteger 
 *   import java.math.BigDecimal
 */
import dagger.ControlFlowGraph


void main() {
    // parse command-line arguments
    if ( args.length != 1 ) {
        println("usage: ./dg <source-file>")
        System.exit(-1)
    }

    final sourceFilename = args[0]

    // load source file
    final sourceText = new File(sourceFilename).text

    // build control flow graph
    final cfg = new ControlFlowGraph()
    cfg.generate(sourceText)

    // print mermaid diagram
    final mmd = cfg.renderMmd()

    println(mmd)
}


main()
