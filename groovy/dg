#!/usr/bin/env groovy

import dagger.ControlFlowGraph


void main() {
    // parse command-line arguments
    if ( args.length != 1 ) {
        println("usage: ./dg <source-file>")
        System.exit(-1)
    }

    // load source file
    final sourceText = new File(args[0]).text

    // build control flow graph
    final cfg = new ControlFlowGraph()
    cfg.generate(sourceText)

    // print mermaid diagram
    final mmd = cfg.renderMmd()

    println(mmd)
}


main()
